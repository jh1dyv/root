<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX lwarp package" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>Springhead - How to use CMake</title>
<link rel="stylesheet" type="text/css" href="lwarp_sagebrush.css" />
</head>
<body>
<header>


</header>
<section class="textbody">
<div class="titlepage">

<h1> Springhead - How to use CMake</h1>

<div class="author">

<div class="oneauthor">

</div>

</div>

<div class="titledate">

</div>

</div>
<h3 id="autosec-3"> Contents</h3><a id="autopage-3"></a>

<nav class="toc">

<p><a href="2ukqrQFbNykczxHg.html#autosec-6" class="tocchapter"
><span class="sectionnumber">1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-7" class="tocsection"
><span class="sectionnumber">1.1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-8" class="tocsubsection"
><span class="sectionnumber">1.1.1</span>&#x2001;従来の方法</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-10" class="tocsubsection"
><span class="sectionnumber">1.1.2</span>&#x2001;CMakeを使用した場合</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-13" class="tocsubsection"
><span class="sectionnumber">1.1.3</span>&#x2001;CMakeを使用した場合の問題点</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-14" class="tocsubsection"
><span class="sectionnumber">1.1.4</span>&#x2001;対処法</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-18" class="tocchapter"
><span class="sectionnumber">2</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-19" class="tocsection"
><span class="sectionnumber">2.1</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-20" class="tocsubsection"
><span class="sectionnumber">2.1.1</span>&#x2001;Springheadライブラリのダウンロード</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-24" class="tocsubsection"
><span class="sectionnumber">2.1.2</span>&#x2001;準備</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-27" class="tocsubsection"
><span class="sectionnumber">2.1.3</span>&#x2001;cmakeの実行</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-31" class="tocsubsection"
><span class="sectionnumber">2.1.4</span>&#x2001;ライブラリのビルド</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-33" class="tocchapter"
><span class="sectionnumber">3</span>&#x2001;Springheadを開発する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-34" class="tocsection"
><span class="sectionnumber">3.1</span>&#x2001;Springheadを開発する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-35" class="tocsubsection"
><span class="sectionnumber">3.1.1</span>&#x2001;準備</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-40" class="tocsubsection"
><span class="sectionnumber">3.1.2</span>&#x2001;cmakeの実行</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-41" class="tocsubsection"
><span class="sectionnumber">3.1.3</span>&#x2001;アプリケーションプログラムのビルド</a></p>


</nav>
<h3 id="autosec-4"> List of Figures</h3><a id="autopage-4"></a>

<nav class="lof">

<p><a href="2ukqrQFbNykczxHg.html#autoid-2" class="tocfigure"
><span class="sectionnumber">1.1</span>&#x2001;Springhead Library構成</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autoid-3" class="tocfigure"
><span class="sectionnumber">1.2</span>&#x2001;Application構成</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autoid-4" class="tocfigure"
><span class="sectionnumber">1.3</span>&#x2001;ビルドの最適性への対処法</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autoid-5" class="tocfigure"
><span class="sectionnumber">1.4</span>&#x2001;プロジェクトファイルの最適性への対処法</a></p>


<p><a href="COtOfv3iniSnphzw.html#autoid-8" class="tocfigure"
><span class="sectionnumber">2.1</span>&#x2001;Springheadダウンロード</a></p>


<p><a href="COtOfv3iniSnphzw.html#autoid-12" class="tocfigure"
><span class="sectionnumber">2.2</span>&#x2001;cmake configure</a></p>


<p><a href="COtOfv3iniSnphzw.html#autoid-13" class="tocfigure"
><span class="sectionnumber">2.3</span>&#x2001;cmake generator</a></p>


</nav>

</section>

<footer>

</footer>

</body>
</html>
<!--|Start file|CMakeとは何をするものか.html|-->

<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX lwarp package" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>Springhead - How to use CMake — CMakeとは何をするものか</title>
<link rel="stylesheet" type="text/css" href="lwarp_sagebrush.css" />
</head>
<body>


<a id="autopage-5"></a> <nav class="topnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

<header>

</header>

<h1>Springhead - How to use CMake</h1>
<nav class="sidetoc">

<div class="sidetoctitle">

<p>Contents</p>


</div>

<div class="sidetoccontents">

<p><a href="main_html.html" class="linkhome"
>Home</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-6" class="tocchapter"
><span class="sectionnumber">1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-7" class="tocsection"
><span class="sectionnumber">1.1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-18" class="tocchapter"
><span class="sectionnumber">2</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-19" class="tocsection"
><span class="sectionnumber">2.1</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-33" class="tocchapter"
><span class="sectionnumber">3</span>&#x2001;Springheadを開発する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-34" class="tocsection"
><span class="sectionnumber">3.1</span>&#x2001;Springheadを開発する方へ</a></p>


</div>

</nav>

<section class="textbody">

<h3 id="autosec-6"> <span class="sectionnumber">1&#x2001;</span>CMakeとは何をするものか</h3><a id="autopage-6"></a>

<a id="WhatCMakeWillDo"></a>
<h4 id="autosec-7"> <span class="sectionnumber">1.1&#x2001;</span>CMakeとは何をするものか</h4><a id="autopage-7"></a>

<a id="sec:WhatCMakeWillDo"></a>

<p>最初にCmakeとは何をするものかについて簡単に説明をします。 Springheadの開発に携わらない方はこの章の内容は不要です。 “<a href="COtOfv3iniSnphzw.html#sec:ForNonDevelopper">2.1</a> Springheadをライブラリとして利用する方へ”をお読みください。
また、Cmakeについて理解をされている方は “<a href="2ukqrQFbNykczxHg.html#subsec:Problems">1.1.3</a> CMakeを使用した場合の問題点”、 “<a href="CMakeとは何をするものか.html#subsec:Solution">1.1.4</a> 対処法”および “<a
href="Springheadを開発する方へ.html#sec:ForDevelopper">3.1</a> Springheadを開発する方へ”をお読みください。</p>
<h5 id="autosec-8"> <span class="sectionnumber">1.1.1&#x2001;</span>従来の方法</h5><a id="autopage-8"></a>

<a id="subsec:ConventionalMethod"></a>

<p>GitHubからSpringheadをダウンロードすると、 Springheadライブラリをビルドするためのソリューションファイル およびプロジェクトファイルがその中に含まれています。</p>


<ul style="list-style-type:none">

<li>
<figure id="autoid-1" class="figure ">
<div class="center">
<p>
<a href="fig/DownloadTree.svg" target="_blank"
><img src="fig/DownloadTree.svg"
style="width:390pt; "
class="inlineimage"
></a></p>

</div>
<a id="fig:DownloadTree"></a>
</figure>
</li>
</ul>

<p>上記のソリューションファイル[*1]を実行すればSpringheadライブラリを生成することができ、 アプリケーションプログラム用のソリューションファイルに 上記のプロジェクトファイル[*2]を“既存のプロジェクト”として追加すれば、 アプリケーションとSpringheadラ
イブラリの開発を同時に行なうことができました。</p>


<p>後者の場合は、プロジェクトファイル[*2]は直接共有されることになります。 このため、複数のソリューションファイルを同時に開き、あるアプリケーションで プロジェクトファイル[*2]に変更が及ぶような修正(ソースファイルの追加・削除)を実施しても、 その変更は
他のアプリケーションに直ちに反映されました。 (プロジェクトが環境外で変更された旨のダイアログが出ます）</p>


<p>この方法はうまく機能していますが、次の点が難点として挙げられます。</p>


<ul style="list-style-type:none">

<li>
<p>• Visual Studioのバージョンが変わる度に、 ソリューションファイルとプロジェクトファイルを作り直す必要がある。</p>

</li>
<li>
<p>• Windows以外のプラットフォームに対しては、 Makefileなどを別途作成する必要がある。</p>

</li>
</ul>
<h5 id="autosec-10"> <span class="sectionnumber">1.1.2&#x2001;</span>CMakeを使用した場合</h5><a id="autopage-10"></a>

<a id="subsec:WhenUsedCMake"></a>

<p>CMakeは、Visual Studioやmakeのように ソースコードのビルドやデバッグの制御をすることを目的としたツールではなく、 ビルドの自動化を図るためのツールです。 CMakeは、"CMakeLists.txt"というパラメータファイルから solution/project file (Windows
Visual Studio)やMakefile (unix make)を自動的に生成します (unixのconfigureに近いものと考えていただいてよいでしょう)。</p>


<p>Cmakeはout of source (out of place)によるビルドに対応しています。 これはソースツリーの「外側」にビルドツリーを生成する機能で、次のような特徴があります。</p>


<ul style="list-style-type:none">

<li>
<p>• 互いに干渉しない複数のビルドツリーを作成することができる。</p>

</li>
<li>
<p>• ビルドツリーが削除されてもソースツリーに影響が及ばない。</p>

</li>
</ul>

<p>我々はCMakeをout of sourceの方法で使用します。</p>


<p>ソースツリーおよびビルドツリーは次のようになるでしょう (図<a href="2rgZt0T7lfFaxUHi.html#fig:SpringheadLibraryTree">??</a>および図<a href="CMakeとは何をするものか.html#fig:ApplicationTree">1.2</a>)。</p>


<ul style="list-style-type:none">

<li>
<figure id="autoid-2" class="figure ">
<div class="center">
<p>
<a href="fig/LibraryTree.svg" target="_blank"
><img src="fig/LibraryTree.svg"
style="width:390pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                                         1.1:&nbsp;Springhead   Library構   成</p>

</figcaption>
<a id="fig:SpringheadLibraryTree"></a>
</figure>
</li>
</ul>

<ul style="list-style-type:none">

<li>
<figure id="autoid-3" class="figure ">
<div class="center">
<p>
<a href="fig/ApplicationTree.svg" target="_blank"
><img src="fig/ApplicationTree.svg"
style="width:390pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                                                    1.2:&nbsp;Application構   成</p>

</figcaption>
<a id="fig:ApplicationTree"></a>
</figure>
</li>
</ul>

<p>"CMakeLists.txt"はメインディレクトリおよびサブディレクトリのそれぞれに作成します。</p>
<h5 id="autosec-13"> <span class="sectionnumber">1.1.3&#x2001;</span>CMakeを使用した場合の問題点</h5><a id="autopage-13"></a>

<a id="subsec:Problems"></a>

<p>前節の図<a href="2ukqrQFbNykczxHg.html#fig:ApplicationTree">1.2</a>に示したような アプリケーションApp1 の他にアプリケーションApp2 があったとして、 その両方を同時に開いて作業を行なう場合を考えます。 ここではApp1 とApp2 が共通して参照す
るSpringheadライブラリのプロジェクトについてのみ考えます。</p>


<p>ソースファイルの整合性            </p>


<ul style="list-style-type:none">

<li>
<p>ソースファイルの整合性には問題がありません。 App1 とApp2 のどちらもSpringheadライブラリのソースツリーを指すようにしてありますから、 どちらで実施したソースファイルの変更も直ちに他方に反映されることになります。 (同じファイルを参照しているのです
から当然です)</p>

<p> ソースファイルの追加や削除を実施したとしても ソースファイルの整合性自体が崩れるわけではありません。 ただし、この場合には“プロジェクトファイルの整合性”の問題が発生します。</p>

</li>
</ul>

<p>ビルドの最適性(無駄なコンパイル)                </p>


<ul style="list-style-type:none">

<li>
<p>App1 とApp2 のビルドツリーは異なるものですから、 App1 でソースを変更してビルドしたとしても そのビルド結果(オブジェクトファイル)がそのままApp2 に反映されることはありません。 これらは異なるファイルです。</p>

                                                                                                    。 従来はオブジェクトファイルも共有されていましたから、 このよ
<p> App2 でソースの変更を反映させようとすれば App2 で再ビルドを行なう必要があります (この時点で変更されている ソースファイルが再コンパイルされ、オブジェクトファイルの整合性がとれます）
うな無駄なコンパイルは発生しませんでした。</p>

</li>
</ul>

<p>プロジェクトファイルの整合性                </p>


<ul style="list-style-type:none">

<li>
<p>ソースファイルの内容を修正しただけならば プロジェクトファイルが変更されることはありません。 しかし、ソースファイルの追加や削除を行なったならば プロジェクトファイルにも変更が及びます (Visual Studio上でソースの追加・削除を行なってセーブを行なった
場合、 もしくはApp1 での変更後に再cmakeを行なった場合)。</p>

<p> プロジェクトファイルもオブジェクトファイルと同様に ビルドツリー内に生成されますから、 App1 で実施した変更がApp2 に反映されることはありません。 しかもApp2 で再ビルドしたとしてもApp1 での変更が反映されることはありません。 App2 のプロジェク
トファイルはApp1 のものとは異なるファイルですから App2 は依然として古い状態を残したままなのです。</p>

<p> これを解消するにはApp2 で再度cmakeを実行する必要がありますが、 問題は“いつ再cmakeが必要なのかが分からない”ということです。</p>

</li>
</ul>
<h5 id="autosec-14"> <span class="sectionnumber">1.1.4&#x2001;</span>対処法</h5><a id="autopage-14"></a>

<a id="subsec:Solution"></a>

<p>前節で示した問題点への対処法について述べます。</p>


<p>ソースファイルの整合性            </p>


<ul style="list-style-type:none">

<li>
<p>Springheadライブラリのソースツリーにあるプロジェクトディレクトリ (Base, Collision, ...)を 直接‘add_subdirectory’すれば問題ありません。</p>

</li>
</ul>

<p>ビルドの最適性(無駄なコンパイル)                </p>


<ul style="list-style-type:none">

<li>
<p>Springheadライブラリ, App1, App2 などのすべてにおいて、 ライブラリのオブジェクトが生成される場所を共通化してしまうことで この問題を回避することとします。 具体的には、Springheadライブラリソースツリーの中(ビルドツリーの外)に オブジェクトの共通
格納場所を作り、 Springheadライブラリおよびすべてのアプリケーションのオブジェクト格納領域が そこを指すようにlinkを張ることとします。</p>

<figure id="autoid-4" class="figure ">
<div class="center">
<p>
<a href="fig/ApproachToBuildOptimization.svg" target="_blank"
><img src="fig/ApproachToBuildOptimization.svg"
style="width:390pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                        1.3:&nbsp;ビ                ル     ド   の      最           適           性          へ     の   対   処        法</p>

</figcaption>
<a id="fig:ApproachToBuildOptimization"></a>
</figure>
<p>オブジェクトの共通格納領域を設定する作業はSpringheadライブラリのcmake (configure)時に、 linkを張る作業はアプリケーションのcmake (configure)時に行なうものとします。</p>

</li>
</ul>

<p>プロジェクトファイルの整合性               </p>


<ul style="list-style-type:none">

<li>
<p>ビルドの最適性の場合と同様、 プロジェクトファイルも共通化することでこの問題に対処します。 具体的には、すべてのアプリケーションのプロジェクトファイルは、 Springheadライブラリビルドツリーにあるプロジェクトファイルを参照するlinkとします。</p>

<p> ただしこれでは不完全で、App1 で実施したプロジェクトファイルへの変更が App2 に伝わりません。 このためApp1 でプロジェクトファイルを変更した場合には、 その変更をSpringheadライブラリビルドツリーにあるプロジェクトファイルに反映させるものとしま
す。 つまり、Springheadライブラリのビルドツリーにあるプロジェクトファイルを 常に最新の状態に保つということです。</p>

<p> この作業はアプリケーションのビルド時に行なうものとします。 そのために、各アプリケーションのソリューションファイルに 特別なターゲット‘sync’を作成し、 このターゲットが毎回のビルドに先立って実行されるようにします。</p>

<figure id="autoid-5" class="figure ">
<div class="center">
<p>
<a href="fig/ApproachToProjfileOptimization.svg" target="_blank"
><img src="fig/ApproachToProjfileOptimization.svg"
style="width:390pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.              1.4:&nbsp;プ          ロ          ジ             ェ   ク   ト   フ   ァ   イ   ル   の   最   適   性   へ   の   対   処   法</p>

</figcaption>
<a id="fig:ApproachToProjfileOptimization"></a>
</figure>
<p></p>

</li>
</ul>

</section>

<footer>

</footer>

<nav class="botnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

</body>
</html>
<!--|Start file|Springheadをライブラリとして利用する方へ.html|-->

<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX lwarp package" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>Springhead - How to use CMake — Springheadをライブラリとして利用する方へ</title>
<link rel="stylesheet" type="text/css" href="lwarp_sagebrush.css" />
</head>
<body>


<a id="autopage-17"></a> <nav class="topnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

<header>

</header>

<h1>Springhead - How to use CMake</h1>
<nav class="sidetoc">

<div class="sidetoctitle">

<p>Contents</p>


</div>

<div class="sidetoccontents">

<p><a href="main_html.html" class="linkhome"
>Home</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-6" class="tocchapter"
><span class="sectionnumber">1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-7" class="tocsection"
><span class="sectionnumber">1.1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-18" class="tocchapter"
><span class="sectionnumber">2</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-19" class="tocsection"
><span class="sectionnumber">2.1</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-33" class="tocchapter"
><span class="sectionnumber">3</span>&#x2001;Springheadを開発する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-34" class="tocsection"
><span class="sectionnumber">3.1</span>&#x2001;Springheadを開発する方へ</a></p>


</div>

</nav>

<section class="textbody">

<h3 id="autosec-18"> <span class="sectionnumber">2&#x2001;</span>Springheadをライブラリとして利用する方へ</h3><a id="autopage-18"></a>

<a id="ForSpringheadUsers"></a>
<h4 id="autosec-19"> <span class="sectionnumber">2.1&#x2001;</span>Springheadをライブラリとして利用する方へ</h4><a id="autopage-19"></a>

<a id="sec:ForNonDevelopper"></a>

<p>この章は、Springheadをライブラリとして利用する方のために、 ライブラリファイルの作成方法について説明します。</p>
<h5 id="autosec-20"> <span class="sectionnumber">2.1.1&#x2001;</span>Springheadライブラリのダウンロード</h5><a id="autopage-20"></a>

<a id="subsec:Download"></a>

<p>まずSpringhead LibraryをGitHubからダウンロード(clone)してください。 以下、ダウンロードするディレクトリを"C:/Springhead"として説明を進めます。</p>


<figure id="autoid-6" class="figure ">
<div class="center">

<p>
<a href="fig/command-2-1-a.svg" target="_blank"
><img src="fig/command-2-1-a.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>サブモジュールを選択する場合は、</p>


<figure id="autoid-7" class="figure ">
<div class="center">

<p>
<a href="fig/command-2-1-b.svg" target="_blank"
><img src="fig/command-2-1-b.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>GUIの場合は、        </p>


<ul style="list-style-type:none">

<li>
<figure id="autoid-8" class="figure ">
<div class="center">
<p>
<a href="fig/SpringheadClone1.svg" target="_blank"
><img src="fig/SpringheadClone1.svg"
style="width:217pt; "
class="inlineimage"
></a>
<a href="fig/SpringheadClone2.svg" target="_blank"
><img src="fig/SpringheadClone2.svg"
style="width:173pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                                              2.1:&nbsp;Springheadダ   ウ   ン   ロ   ー   ド</p>

</figcaption>
<a id="fig:SpringheadClone"></a>
</figure>
</li>
</ul>
<h5 id="autosec-24"> <span class="sectionnumber">2.1.2&#x2001;</span>準備</h5><a id="autopage-24"></a>

<a id="subsec:PrepareLibrary"></a>

<p>ダウンロードが済んだら"C:/Springhead/core/src"に移動してください。</p>


<p>まず、配布されたファイル"CMakeLists.txt.Lib.dist"を "CMakeLists.txt"という名前でコピーします (誤コミットを防止するためにもリネームではなくコピーしてください）
                                                                                                       。</p>


<figure id="autoid-9" class="figure ">
<div class="center">

<p>
<a href="fig/command-2-2-a.svg" target="_blank"
><img src="fig/command-2-2-a.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>自前でインストールしているパッケージ (boost, glew, freeglut, glui)を使用する場合 およびライブラリファイルとヘッダファイルのインストール先を指定する場合には、 さらに、 配布されたファイル"CMakeConf.txt.dist"を"CMakeConf.txt"という名前でコピーして
必要な編集をします。 編集の方法については"CMakeConf.txt"に記述されています (“#set(variable value )”から“#”を削除し、 “value ”を適切に設定し直す)。</p>


<figure id="autoid-10" class="figure ">
<div class="center">

<p>
<a href="fig/command-2-2-b.svg" target="_blank"
><img src="fig/command-2-2-b.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>以上で準備作業は終了です。</p>
<h5 id="autosec-27"> <span class="sectionnumber">2.1.3&#x2001;</span>cmakeの実行</h5><a id="autopage-27"></a>

<a id="subsec:CmakeLibrary"></a>

<p>以下では、cmakeの生成物(ビルドの生成物ではありません)を格納する 作業場所(ディレクトリ)を“build ”として話を進めます(作業場所は任意で構いません)。</p>


<p>cmakeにはConfigureとGenerateの2段階があります。</p>


<p>コマンドプロンプトの場合は、1回のコマンドで両方を実行できます。</p>


<figure id="autoid-11" class="figure ">
<div class="center">

<p>
<a href="fig/command-2-3.svg" target="_blank"
><img src="fig/command-2-3.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>GUIの場合は、        </p>


<ul style="list-style-type:none">

<li>
<p>まずConfigureボタン(図<a href="COtOfv3iniSnphzw.html#fig:CmakeConfigure">2.2</a> 左図の下)を押します。</p>

<figure id="autoid-12" class="figure ">
<div class="center">
<p>
<a href="fig/CmakeConfigure1.svg" target="_blank"
><img src="fig/CmakeConfigure1.svg"
style="width:152pt; "
class="inlineimage"
></a>
<a href="fig/CmakeConfigure2.svg" target="_blank"
><img src="fig/CmakeConfigure2.svg"
style="width:87pt; "
class="inlineimage"
></a>
<a href="fig/CmakeConfigure3.svg" target="_blank"
><img src="fig/CmakeConfigure3.svg"
style="width:130pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                                                                           2.2:&nbsp;cmake                                                                           configure</p>

</figcaption>
<a id="fig:CmakeConfigure"></a>
</figure>
<p>build ディレクトリがなければ作成するかどうか聞かれ(同中央図)、 次にgenerator指定画面となります(同右図)。 cmake version 3.15.0では、 generatorとして図<a href="COtOfv3iniSnphzw.html#fig:CmakeGenerator">2.3</a>のものが指定できます。</p>

<figure id="autoid-13" class="figure ">
<div class="center">
<p>
<a href="fig/CmakeConfigure4.svg" target="_blank"
><img src="fig/CmakeConfigure4.svg"
style="width:130pt; "
class="inlineimage"
></a></p>

</div>
<figcaption>
<p>Fig.                                                                                   2.3:&nbsp;cmake   generator</p>

</figcaption>
<a id="fig:CmakeGenerator"></a>
</figure>
<p>最後に図<a href="COtOfv3iniSnphzw.html#fig:CmakeConfigure">2.2</a> 左図の下のGenerateボタンを押します。</p>

</li>
</ul>

<p>以上で、build 以下にsolution/project fileなどが生成されたはずです。</p>
<h5 id="autosec-31"> <span class="sectionnumber">2.1.4&#x2001;</span>ライブラリのビルド</h5><a id="autopage-31"></a>

<a id="subsec:BuildLibrary"></a>

<p>Springhead Libraryのビルド方法は、従来と変わりがありません。<br />
build へ移動し、"Springhead.sln"を指定してVisual Studioを実行してください。</p>


<p>“<a href="COtOfv3iniSnphzw.html#subsec:PrepareLibrary">2.1.2</a> 準備”でライブラリファイルのインストール先を 指定していなければ、ライブラリファイルは次のいずれかに生成されます。</p>


<p><span style="width:20pt; display:inline-block"></span>"C:/Springhead/generated/lib/win64"<br />
または<br />
<span style="width:20pt; display:inline-block"></span>"C:/Springhead/generated/lib/win32"<br />
</p>


</section>

<footer>

</footer>

<nav class="botnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

</body>
</html>
<!--|Start file|Springheadを開発する方へ.html|-->

<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX lwarp package" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>Springhead - How to use CMake — Springheadを開発する方へ</title>
<link rel="stylesheet" type="text/css" href="lwarp_sagebrush.css" />
</head>
<body>


<a id="autopage-32"></a> <nav class="topnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

<header>

</header>

<h1>Springhead - How to use CMake</h1>
<nav class="sidetoc">

<div class="sidetoctitle">

<p>Contents</p>


</div>

<div class="sidetoccontents">

<p><a href="main_html.html" class="linkhome"
>Home</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-6" class="tocchapter"
><span class="sectionnumber">1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="2ukqrQFbNykczxHg.html#autosec-7" class="tocsection"
><span class="sectionnumber">1.1</span>&#x2001;CMakeとは何をするものか</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-18" class="tocchapter"
><span class="sectionnumber">2</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="COtOfv3iniSnphzw.html#autosec-19" class="tocsection"
><span class="sectionnumber">2.1</span>&#x2001;Springheadをライブラリとして利用する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-33" class="tocchapter"
><span class="sectionnumber">3</span>&#x2001;Springheadを開発する方へ</a></p>


<p><a href="2rgZt0T7lfFaxUHi.html#autosec-34" class="tocsection"
><span class="sectionnumber">3.1</span>&#x2001;Springheadを開発する方へ</a></p>


</div>

</nav>

<section class="textbody">

<h3 id="autosec-33"> <span class="sectionnumber">3&#x2001;</span>Springheadを開発する方へ</h3><a id="autopage-33"></a>

<a id="ForSpringheadDevelopper"></a>
<h4 id="autosec-34"> <span class="sectionnumber">3.1&#x2001;</span>Springheadを開発する方へ</h4><a id="autopage-34"></a>

<a id="sec:ForDevelopper"></a>

<p>この章では、Springheadの開発を行なう方のために、 cmakeを使用したアプリケーションプログラムの作成方法について説明します。</p>


<p>アプリケーションプログラムについての作業をする前に、 あらかじめSpringehadライブラリをダウンロードしてcmakeを実行しておいてください (“<a href="COtOfv3iniSnphzw.html#sec:ForNonDevelopper">2.1</a> Springheadをライブラリとして利用する方”参
照)。</p>
<h5 id="autosec-35"> <span class="sectionnumber">3.1.1&#x2001;</span>準備</h5><a id="autopage-35"></a>

<a id="subsec:PrepareApplication"></a>

<p>アプリケーションと並行してSpringheadライブラリを開発する場合には、 “<a href="2ukqrQFbNykczxHg.html#subsec:Problems">1.1.3</a> CMakeを使用した場合の問題点”で示した問題に対処する必要があるため、 ここで述べる方法に従って作業を進めてください
(“<a href="2ukqrQFbNykczxHg.html#subsec:Solution">1.1.4</a> 対処法”で示した方策が組み込まれます)。</p>


<p>以下、Springheadライブラリをダウンロードしたディレクトリを"C:/Springhead" 、 アプリケーションプログラムを作成するディレクトリを"C:/Develop/Application"として説明を進めます。</p>


<p>"C:/Develop/Application"に移動してください。</p>


<p>配布されたファイル"CMakeTopdir.txt.dist"を"CMakeTopdir.txt"という名前で、 "CMakeLists.txt.Dev.dist"を"CMakeLists.txt"という名前でコピーします (誤ってコミットするのを防ぐためにも、リネームではなくコピーしてください）
                                                                                                                                                       。</p>


<figure id="autoid-14" class="figure ">
<div class="center">

<p>
<a href="fig/command-3-1-a.svg" target="_blank"
><img src="fig/command-3-1-a.svg"
style="width:434pt; "
class="inlineimage"
></a></p>


</div>

<a id="fig:DownloadTree"></a>

</figure>

<p>"CMakeTopdir.txt"の編集         </p>


<ul style="list-style-type:none">

<li>
<p>Springheadライブラリをダウンロードしたディレクトリを"CMakeTopdir.txt"にはSpringheadライブラリに設定します。 これは、CMakeにSpringheadのソースツリーの場所を教えるために必要な設定です。</p>

<figure id="autoid-15" class="figure ">
<div class="center">
<p>
<a href="fig/command-3-1-b.svg" target="_blank"
><img src="fig/command-3-1-b.svg"
style="width:434pt; "
class="inlineimage"
></a></p>

</div>
<a id="fig:DownloadTree"></a>
</figure>
</li>
</ul>

<p>"CMakeLists.txt"の編集     </p>


<ul style="list-style-type:none">

<li>
<ul style="list-style-type:none">

<li>
<p>1. プロジェクト名を設定します(11行目)。</p>

<figure id="autoid-16" class="figure ">
<div class="center">
<p>
<a href="fig/command-3-1-b.svg" target="_blank"
><img src="fig/command-3-1-b.svg"
style="width:434pt; "
class="inlineimage"
></a></p>

</div>
<a id="fig:DownloadTree"></a>
</figure>
</li>
<li>
<p>2. Customization section (19行目以降)を必要に応じて変更します。<br />
各変数の意味は次のとおりです。</p>

<ul style="list-style-type:none">

<li>
<table>
<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">OOS_BLD_DIR</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">CMakeの作業領域(ディレクトリ)の名前(本ドキュ</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">メントでbuild としているもの)。</td>
</tr>

<tr class="hline" >
<td colspan="2" class="tdl tvertbarl tvertbarr" style="border-left:   1px solid #; border-right:   1px solid #">CMAKE_CONFIGURATION_TYPES</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">ビルド構成。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">SRCS</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">ビルドの対象とするファイル。 設定はset(SRCS …)</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">またはfile(GLOB SRCS …)とします。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">後者ではワイルドカードが使えます。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">SRCSの直後に“RELATIVE &lt;base-dir &gt;”を付加すると</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">相対パス指定となります。デフォルトは</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #"> file(GLOB RELATIVE &dollar;{CMAKE_SOURCE_DIR} *.cpp *.h)</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">です。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">EXCLUDE_SRCS</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">ビルドの対象から外すファイル。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">上のSRCSでRELATIVEとしていないときは絶対パス</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">で指定します。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">SRCSでワイルドカードを使用した場合に有用です。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">SPR_PROJS</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">アプリケーションに組み込むSpringheadライブラリ</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">のプロジェクト名。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">不要なプロジェクト名を削除します。 この中にRun-</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">Swigを含めてはいけません。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">ADDITIONAL_INCDIR</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">追加のインクルードパス指定。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">現在のディレクトリは &dollar;{CMAKE_SOURCE_DIR}で参照</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">できます。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">ADDITIONAL_LIBDIR</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">追加のライブラリパス指定。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">ADDITIONAL_LIBS</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">追加のライブラリファイル名。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">EXCLUDE_LIBS</td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">linkの対象から外すライブラリファイル名。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">デフォルトで組み込まれてしまうライブラリファイル</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">を排除するために指定します。</td>
</tr>

<tr class="hline" >
<td class="tdl tvertbarl tvertbarr" style="border-left:   1px solid #; border-right:   1px solid #"> <td colspan="2" class="tdl tvertbarl tvertbarr" style="border-left:   1px solid #; border-right:   1px solid
#">DEBUGGER_WORKING_DIRECTORY</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #">                           </td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">Visual Studio Debuggerの作業ディレクトリ名。</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">デバッガはこのディレクトリで起動されたように振る</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right:     1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">舞います。</td>
</tr>

<tr class="hline" >
<td colspan="2" class="tdl tvertbarl tvertbarr" style="border-left:   1px solid #; border-right:   1px solid #">DEBUGGER_COMMAND_ARGUMENTS</td>
</tr>

<tr>
<td class="tdl tvertbarl tvertbarr" style="border-left: 1px solid #; border-right: 1px solid #"></td>
<td class="tdl tvertbarr" style="border-right: 1px solid #">Visual Studio Debuggerに渡すコマンド引数</td>
</tr>

<tr class="hline" >
<td class="tdl"></td>
<td class="tdl"></td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<p>自前でインストールしているパッケージ (boost, glew, freeglut, glui)を使用する場合には、 さらに、 配布されたファイル"CMakeConf.txt.dist"を"CMakeConf.txt"という名前でコピーして 必要な編集をします。 “<a
href="Springheadをライブラリとして利用する方へ.html#subsec:PrepareLibrary">2.1.2</a> 準備”を参照してください。</p>


<p>ビルドの条件(compile/linkのパラメータ)を変更したいときは、 配布されたファイル"CMakeOpts.txt.dist"を"CMakeOpts.txt"という名前でコピーして 適宜変更してください。</p>


<p>以上で準備作業は終了です。</p>
<h5 id="autosec-40"> <span class="sectionnumber">3.1.2&#x2001;</span>cmakeの実行</h5><a id="autopage-40"></a>

<a id="subsec:CmakeApplication"></a>

<p>cmakeの実行手順については、 “<a href="COtOfv3iniSnphzw.html#subsec:CmakeLibrary">2.1.3</a> cmakeの実行”と同じですから、 そちらを参照してください。 ここでは、cmakeを実行することで “<a
href="CMakeとは何をするものか.html#subsec:Solution">1.1.4</a> 対処法”で示した対策がどのように実施されるかについて述べます。</p>


<p>ビルドの最適性         </p>


<ul style="list-style-type:none">

<li>
<p>組み込まれているSpringheadライブラリの各プロジェクト (ここではBaseを例にします)に対して<br />
<span style="width:20pt; display:inline-block"></span>"C:/Springhead/core/src/Base/&lt;x64&gt; /&lt;15.0&gt; /Base.dir"(*1)<br />
というディレクトリを作成し、 "C:/Develop/Application/build /Base/Base.dir"から上記ディレクトリ(*1)へ linkを張る作業をcmake configure時に(自動的に)行ないます。</p>

</li>
</ul>

<ul style="list-style-type:none">

<li>
<p><span style="background:black; width:867pt ; height:1pt ; display:inline-block;"></span><br />
これに関して皆さんが行なうべきことはありませんが、 次のことに注意してください。</p>

<ul style="list-style-type:none">

<li>
<p>1. cmakeをした後でSpringheadソースツリー上ので上記ディレクトリ (*1)を削除すると、以降のビルドで<br />
<span style="width:15pt; display:inline-block"></span>“エラー MSB3191 ディレクトリ"Base.dir/Debug/"を作成できません。”</p>

<p>というエラーが発生します。</p>

</li>
<li>
<p>2. Springheadライブラリ側でcmake (configure)を実行していないと オブジェクトの共通格納領域が作成されていないため、 前項と同じエラーが発生します。</p>

</li>
<li>
<p>3. アプリケーション側で"C:/Develop/Application/build /Base/Base.dir"を削除すると、 ビルド時にVisual Studioがbuild 下に"Base.dir"を 自動的に作成するためにビルドの最適性が崩れてしまいます (無駄なビルドが発生するだけで、ビルド自体は正常に行なえま
す)。    </p>

<ul style="list-style-type:none">

<li>
<p>Windowsでは実行権限の都合上linkをjunctionで実現していますが、 explorerでもcommand prompt上でも"Base.dir"がjunctionか 通常のディレクトリかの区別がつきません。 そのためこのような事態の発見が困難になる可能性があります。</p>

</li>
</ul>
</li>
</ul>
<p>これらの状態を解消するためには、アプリケーション側 (もしくはSpringheadライブラリ側)で再度cmakeを実行する必要があります。</p>

<p><span style="background:black; width:867pt ; height:1pt ; display:inline-block;"></span></p>

</li>
</ul>

<p>プロジェクトファイルの整合性               </p>


<ul style="list-style-type:none">

<li>
<p>“<a href="2ukqrQFbNykczxHg.html#subsec:Solution">1.1.4</a> 対処法”でも述べたように、 プロジェクトファイル(ソリューションファイルの含む。以下同様)は Springheadライブラリのビルドツリーにあるものを最新の状態に保つことを前提として、 アプリケーシ
ョン側のプロジェクトファイルは これらSpringhead側にあるものへのlinkとなるようにします。 このためにアプリケーションプログラムのソリューションに syncというターゲットを追加して、次の処理を実行させます。 </p>

<ul style="list-style-type:none">

<li>
<p>1. もしもアプリケーション側のプロジェクトファイルの内容と Springhead側のプロジェクトファイルの内容とが異なっていたならば、 アプリケーション側のプロジェクトファイルを Springhead側にコピーする。                            </p>

<ul style="list-style-type:none">

<li>
<p>これは、アプリケーション側でソースファイル構成を変更 (ファイルの追加・削除)を行ない、 Visual Studio上でプロジェクトファイルを保存したとき、 またはアプリケーション側で再度cmakeを実行したときです。</p>

</li>
</ul>
</li>
<li>
<p>2. アプリケーション側のプロジェクトファイルをSpringhead側の プロジェクトファイルへのlinkとする。</p>

</li>
</ul>
<p>ターゲットsyncはアプリケーションのビルドにおいて 必ず最初に実行されるように依存関係が設定されます。</p>

</li>
</ul>

<ul style="list-style-type:none">

<li>
<p><span style="background:black; width:867pt ; height:1pt ; display:inline-block;"></span><br />
次のことに注意してください。</p>

<ul style="list-style-type:none">

<li>
<p>1. Springhead側または他のアプリケーションが実施した変更は、 アプリケーションをビルドするだけで自動的に反映されます。</p>

</li>
<li>
<p>2. 自アプリケーションで実施したソース構成の変更は、 ビルドを実施した時点でSpringhead側に反映されます。 つまり、プロジェクトファイルの整合性を保つためには、 ソース構成の変更後に少なくとも1回はビルドを実行する必要がある ということです(syncの実行
だけでもよい)。    </p>

<ul style="list-style-type:none">

<li>
<p>ソース構成を変更したらビルドするでしょうから、 このことが問題になることはほとんどないと思われます。</p>

<p>もしSpringhead側でプロジェクトファイルが削除されたならば、 ビルドエラー(syncでlink先のファイルが見つからない) となります。</p>

<p>この場合にはSpringhead側で再度cmakeを実行する必要があります (アプリケーション側では駄目)。</p>

</li>
</ul>
</li>
<li>
<p>3. syncターゲットが実行されるとプロジェクトファイルが更新される ことがあるため、“プロジェクトが環境外で変更された”旨の メッセージが出ることがあります。 「すべて再読み込み」としてください。</p>

</li>
</ul>
<p><span style="background:black; width:867pt ; height:1pt ; display:inline-block;"></span></p>

</li>
</ul>
<h5 id="autosec-41"> <span class="sectionnumber">3.1.3&#x2001;</span>アプリケーションプログラムのビルド</h5><a id="autopage-41"></a>

<a id="subsec:BuildApplication"></a>

<p>アプリケーションのビルドは従来と変わりがありませんが、 ソリューションに新しいターゲット ALL_BUILD, syncが追加されています。 ここでは、これらについて説明します。</p>


<p>ALL_BUILD        </p>


<ul style="list-style-type:none">

<li>
<p>これはcmakeが自動的に作成するターゲットでmake allに相当するものと されています。ただしVisual Studio上ではALL_BUILDの依存関係の設定が不正確で、 このターゲットをビルドしても正しい結果は得られないようです。 このターゲットは無視してくださ
い</p>

</li>
</ul>

<p>sync    </p>


<ul style="list-style-type:none">

<li>
<p>これは“<a href="2rgZt0T7lfFaxUHi.html#subsec:CmakeApplication">3.1.2</a> cmakeの実行”で述べたとおり、 プロジェクトファイルの整合性を保つために作られたものです。 Springheadライブラリのプロジェクトを一つでもビルドすれば このターゲットは必ず
最初に実行されますから、 このターゲットに対して何らかのアクションを起こす必要はないでしょう。</p>

</li>
</ul>

<p><span style="background:black; width:867pt ; height:1pt ; display:inline-block;"></span> 補足   </p>


<ul style="list-style-type:none">

<li>
<p>2019/9/30 (commit 1d8e5ce)以前に配布した"CMakeLists.txt.*.dist"を元に "CMakeLists.txt"を作成して使用している場合</p>

<p>RunSwigでclean/rebuildの対応ができていなかったため、 cleanと同等の機能を実現するためのターゲットRunSwig_Cleanが作成されて いるはずです。</p>

<p>上記日付以降のSpringheadライブラリをダウンロードしcmakeを実行していただければ、 RunSwigはclean/rebuild対応となります。 ただし、RunSwig_Cleanをビルドすると            </p>

<ul style="list-style-type:none">

<li>
<p>python: can’t open file ’.../Clean.py’: ... No such file ...</p>

</li>
</ul>
<p>というエラーが起きます。実害はありませんがRunSwigのcleanは行なわれません。</p>

<p> RunSwig_Cleanターゲットを生成されないようにするには、 新しい配布ファイルから"CMakeLists.txt"を再作成するか、 または既存の"CMakeLists.txt"から以下の部分を削除して再cmakeしてください。</p>

<ul style="list-style-type:none">

<li>
<figure id="autoid-17" class="figure ">
<ul style="list-style-type:none">

<li>
<div class="center">
<p><span class="fbox" style="border:1pt solid black ; padding:3pt">
<a href="fig/RemoveRunSwigClean.svg" target="_blank"
><img src="fig/RemoveRunSwigClean.svg"
style="width:347pt; "
class="inlineimage"
></a> </span></p>

</div>
<a id="fig:SpringheadLibraryTree"></a>
</li>
</ul>
</figure>
</li>
</ul>
<p>EmbPython_RunSwig_Cleanについても同様です。</p>

</li>
</ul>
</section>

<footer>

</footer>

<nav class="botnavigation"><a href="main_html.html" class="linkhome"
>Home</a></nav>

</body>
</html>
