% 5.4.12.VisualStudio.tex
%	Last update: 2018/06/07 F.Kanehori
%\newpage
\subsubsection{クラス VisualStudio}
\label{subsubsec:VisualStudio}

\begin{ClassDesc}
visual studioをコマンドラインから使用するためのラッパクラス。
Visual Studio 2015以降に対応。
ただし、Visual Stduio 2017以降については未確認である
(tool setの表記法、\TT{devenv}の格納ディレクトリ等が変更されているかもしれない）。
\end{ClassDesc}

\begin{Initializer}{obj = VisualStudio(toolset, verbose)}
\begin{Params}
    \Param{toolset}{%
	Visual Studio toolset ID\\
	(例) Visual Studio 2015ならば、'14.0', '14', 'v140', '2015'の何れでも可。}
\end{Params}
\end{Initializer}

\begin{Methods}{公開メソッド}
\Method{solution(name)}{%
    \begin{Params}
	\Param{name}{ソリューション名}
    \end{Params}
    \begin{General}
	引数\ARG{name}とVisual Studioのバージョンから
	ソリューションファイル名を決定する。
    \end{General}
}
\Method{set(func,arg1,arg2)}{%
    \begin{General}
	与えられた引数に従ってビルド条件の設定を行なう。
	\LineSkip{3pt}
	\def\COLWIDx{250pt}
	\begin{tabular}{|l|l|}\hline
	    \multicolumn{1}{|c}{\it{func}}
		& \multicolumn{1}{|c|}{設 定 内 容 (\it{arg1,arg2})}\\\hline
	    \tt{OUTDIR}
		& \begin{parcol}{\COLWIDx}{%
			出力ディレクトリを\TT{arg1}に、
			クリーンフラグを\TT{arg2}に設定する。
			クリーンフラグがTrueならば、コンパイル前に
			出力ディレクトリをクリアする(強制リコンパイル)。
		  }\end{parcol}\\\hline
	    \tt{LOGFILE}
		& \begin{parcol}{\COLWIDx}{%
			ログファイルパスを\ARG{arg1}とする。
		  }\end{parcol}\\\hline
	    \tt{DRY_RUN}
		& \begin{parcol}{\COLWIDx}{%
			Dry_runフラグを\ARG{arg1}とする。
			このフラグがTrueならば、
			コマンドを表示するだけで実行はしない。
		  }\end{parcol}\\\hline
	\end{tabular}\\
    \end{General}
}
\Method{build(platform, config)}{%
    \begin{General}
	ログディレクトリを準備したら、
	プラットフォームを\TT{platform}、ビルド構成を\ARG{config}として
	ビルドを実行する(\tt{__build()}を呼ぶ)。
    \end{General}
}
\Method{get(kind)}{%
    \begin{General}
	与えられた引数に対応する値を返す。
	\LineSkip{3pt}
	\def\COLWIDx{250pt}
	\begin{tabular}{|l|l|}\hline
	    \multicolumn{1}{|c}{\it{kind}}
		& \multicolumn{1}{|c|}{返 す 値}\\\hline
	    \tt{VERSION}
		& \begin{parcol}{\COLWIDx}{%
			Visual Studioのバージョン (e.g. 14.0)
		  }\end{parcol}\\\hline
	    \tt{TOOLSET}
		& \begin{parcol}{\COLWIDx}{%
			Visual Studio toolset ID (e.g. "v140")
		  }\end{parcol}\\\hline
	    \tt{TOOLSET}
		& \begin{parcol}{\COLWIDx}{%
			Visual Studioのtoolset IDと名称\ 
			(e.g. "v140" と "Visual Studio 2015")
		  }\end{parcol}\\\hline
	\end{tabular}\\
    \end{General}
}
\Method{info()}{%
    \begin{General}
	現在設定されているパラメータを標準出力に出力する。
    \end{General}
}
\Method{error()}{%
    \begin{General}
	既にエラーが記録されていたらその情報(文字列)を返す。
    \end{General}
}
\end{Methods}

\begin{Methods}{内部メソッド \rm{(抜粋)}}
\Method{__get_vsinfo(toolset)}{%
    \begin{General}
	未作成
    \end{General}
}
\end{Methods}

% end: 5.4.12.VisualStudio.tex
