% 5.4.12.VisualStudio.tex
%	Last update: 2018/06/07 F.Kanehori
%\newpage
\subsubsection{VisualStudio}
\label{subsubsec:VisualStudio}

\medskip
\noindent
\bf{概要}

\begin{narrow}[20pt]
visual studioをコマンドラインから使用するためのラッパクラス。
Visual Studio 2015以降に対応。
ただし、Visual Stduio 2017以降については未確認である
(tool setの表記法、\TT{devenv}の格納ディレクトリ等が変更されているかもしれない）。
\end{narrow}

\bigskip
\noindent
\bf{イニシャライザ} (\tt{__init__})

\vspace{5pt}
\begin{narrow}[20pt]
    \framebox[\linewidth][l]{%
	\begin{tabular}{l}
	    \tt{obj = VisualStudio(toolset, verbose)}
	\end{tabular}}

    \medskip
    引数
    \begin{narrow}[20pt]
	\vspace{5pt}
	\def\COLWID{275pt}
	\begin{longtable}{p{35pt}l}
	    \tt{toolset} & \begin{parcol}{\COLWID}{%
		Visual Studio toolset ID\\
		(例) Visual Studio 2015ならば、
		'14.0', '14', 'v140', '2015'の何れでも可。
	    }\end{parcol}\\
	\end{longtable}
    \end{narrow}
\end{narrow}

%\bigskip
\noindent
\bf{公開メソッド}

\vspace{5pt}
\def\COLWID{270pt}
\begin{enumerate}
  \item	\tt{solution(name)}\\
	引数
	\begin{narrow}[20pt]
	    \begin{tabular}{p{35pt}l}
		\tt{name} & ソリューション名。
	    \end{tabular}
	\end{narrow}

	%\vspace{-10pt}
	概要
	\begin{narrow}[20pt]
		引数\ARG{name}とVisual Studioのバージョンから
		ソリューションファイル名を決定する。
	\end{narrow}
	\medskip

  \item	\tt{set(func, arg1, arg2)}\\
	概要
	\begin{narrow}[20pt]
		与えられた引数に従ってビルド条件の設定を行なう。

		\medskip
		\def\COLWIDx{250pt}
		\begin{tabular}{|l|l|}\hline
		    \multicolumn{1}{|c}{\it{func}}
			& \multicolumn{1}{|c|}{設 定 内 容}\\\hline
		    \tt{OUTDIR}
			& \begin{parcol}{\COLWIDx}{%
				出力ディレクトリを\TT{arg1}に、
				クリーンフラグを\TT{arg2}に設定する。
				クリーンフラグがTrueならば、コンパイル前に
				出力ディレクトリをクリアする(強制リコンパイル)。
			  }\end{parcol}\\\hline
		    \tt{LOGFILE}
			& \begin{parcol}{\COLWIDx}{%
				ログファイルパスを\ARG{arg1}とする。
			  }\end{parcol}\\\hline
		    \tt{DRY_RUN}
			& \begin{parcol}{\COLWIDx}{%
				Dry_runフラグを\ARG{arg1}とする。
				このフラグがTrueならば、
				コマンドを表示するだけで実行はしない。
			  }\end{parcol}\\\hline
		\end{tabular}
	\end{narrow}
	\medskip

  \item	\tt{build(platform, config)}\\
	概要
	\begin{narrow}[20pt]
		ログディレクトリを準備したら、
		プラットフォームを\ARG{platform}、ビルド構成を\ARG{config}として
		ビルドを実行する(\METHOD{__build()}を呼ぶ)。
	\end{narrow}
	\medskip

  \item	\tt{get(kind)}\\
	概要
	\begin{narrow}[20pt]
		与えられた引数に対応する値を返す。

		\medskip
		\def\COLWIDx{250pt}
		\begin{tabular}{|l|l|}\hline
		    \multicolumn{1}{|c}{\it{kind}}
			& \multicolumn{1}{|c|}{返 す 値}\\\hline
		    \tt{VERSION}
			& \begin{parcol}{\COLWIDx}{%
				Visual Studioのバージョン (e.g. 14.0)
			  }\end{parcol}\\\hline
		    \tt{TOOLSET}
			& \begin{parcol}{\COLWIDx}{%
				Visual Studio toolset ID (e.g. "v140")
			  }\end{parcol}\\\hline
		    \tt{TOOLSET}
			& \begin{parcol}{\COLWIDx}{%
				Visual Studioのtoolset IDと名称\ 
				(e.g. "v140" と "Visual Studio 2015")
			  }\end{parcol}\\\hline
		\end{tabular}
	\end{narrow}
	\medskip

  \item	\tt{info()}\\
	概要
	\begin{narrow}[20pt]
		現在設定されているパラメータを標準出力に出力する。
	\end{narrow}
	\medskip

  \item	\tt{error()}\\
	概要
	\begin{narrow}[20pt]
		既にエラーが記録されていたらその情報(文字列)を返す。
	\end{narrow}
	\medskip
\end{enumerate}

\bigskip
\noindent
\bf{内部メソッド \rm{(抜粋)}}

\vspace{5pt}
\def\COLWID{280pt}
\begin{enumerate}
  \item	\tt{__get_vsinfo(toolset)}\\
	概要
	\begin{narrow}[20pt]
		





	\end{narrow}
	\medskip





\end{enumerate}

% end: 5.4.12.VisualStudio.tex
