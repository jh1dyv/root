% 5.4.7.ClosedSrcControl.tex
%	Last update: 2018/06/18 F.Kanehori
%\newpage
\subsubsection{クラス ClosedSrcControl}
\label{subsubsec:ClosedSrcControl}

\begin{Brief}
	Springheadを非公開ソースを使用してビルドするか否かは、
	マクロ\tt{USE_CLOSED_SRC}が定義されるか否かで制御される
	(ファイル\Path{core/include/UseClosedSrcOrNot.h}参照)。
	このクラスでは、上記のマクロを切り替える
	(\,\tt{\#define} $\Leftrightarrow$ \tt{\#undef}\,)ための
	メソッドを提供する。
\end{Brief}

\begin{Initializer}{%
	obj = ClosedSrcControl(path, use_path, unuse_path,\Cont\\
	\Hskip{100pt}dry_run=False, verbose=0)}
	\Vskip{-.4\baselineskip}
	\begin{Opts}[b][5em]
	    \Item[t]{path}{%
		当該マクロを定義しているファイル名\\
		\Path{core/include/UseclosedSrcOrNot.h}を指定する}
	    \Item[t]{use_path}{%
   		closed sourceを使用する場合のテンプレートファイル名\\
		\Path{core/test/bin/UseClosedSrc.h.template}を指定する}
	    \Item[t]{unuse_path}{%
   		closed sourceを使用しない場合のテンプレートファイル名\\
		\Path{core/test/bin/UnuseClosedSrc.h.template}を指定する}
	    \Item[t]{dry_run}{コマンドを表示するだけで実行はしない}
	\end{Opts}
\end{Initializer}

\begin{Methods}{公開メソッド}
\Method{set_usage(usage)}{%
    \begin{Opts}[b][5em]
    	\Item[t]{usage}{%
	    closed sourceを使用してビルドするか否か。
	    \tt{CSU_USE}又は\tt{CSU_UNUSE}を指定する
	    (\Ref{subsubsec}{ConstDefs})。}
    \end{Opts}
    \begin{Brief}
	指定されたusageが現在のマクロ定義と異なる場合は、
	適切なテンプレートを定義ファイルにコピーすることで要求に応じる。
    \end{Brief}
}

\Method{revive()}{%
    \begin{Brief}
	マクロ定義ファイルの内容を元の状態に戻す。
    \end{Brief}
}
\end{Methods}

\begin{Methods}{内部メソッド}
\Method{__read_uage(path)}{%
    \begin{Opts}[b][5em]
    	\Item[t]{path}{マクロ定義ファイル名}
    \end{Opts}
    \begin{Brief}
	指定されたマクロファイルを読み、
	記述されているマクロ定義に従って\tt{CSU_USE}又は\tt{CSU_UNUSE}を返す。
    \end{Brief}
}
\end{Methods}

% end: 5.4.7.ClosedSrcControl.tex
