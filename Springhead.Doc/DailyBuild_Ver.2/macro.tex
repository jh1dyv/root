% macro.tex
%	Last update: 2018/06/16 F.Kanehori

\makeatletter

% need original symbol
\def\orgLA{<}
\def\orgRA{>}

% some character usage
\catcode`\_=\active
\catcode`\^=\active
\catcode`\<=\active
\catcode`\>=\active
\def_{\ifmmode\sb\else\_\fi}
\def^{\ifmmode\sp\else\^\fi}
\def<{\ifmmode\langle\else$\langle$\fi}
\def>{\ifmmode\rangle\else$\rangle$\fi}

% alias for reducing braces
\let\it@\it
\let\tt@\tt
\let\bf@\bf
\let\rm@\rm
\def\it#1{{\it@{#1\,}}}
\def\tt#1{{\tt@{#1}}}
\def\bf#1{{\bf@{#1}}}
\def\rm#1{{\rm@{#1}}}

% 次のものは止める
\def\TT#1{{\tt@{\,#1\,}}}
\def\Tt#1{{\tt@{\,#1}}}
\def\tT#1{{\tt@{#1\,}}}
\def\IT#1{{\it@{\,#1\,}}}
\def\It#1{{\it@{\,#1}}}
\def\iT#1{{\it@{#1\,}}}
\def\Bf#1{{\bf@{\,#1\,}}}
\def\BF#1{{\bf@{\,#1}}}
\def\bF#1{{\bf@{#1\,}}}
\def\Rm#1{{\rm@{\,#1\,}}}
\def\RM#1{{\rm@{\,#1}}}
\def\rM#1{{\rm@{#1\,}}}

% other alias
\let\URL\tt
\def\TT#1{{\tt@{\,#1\,}}}

%% dimensions
%\def\HSKIP{\hspace{2ZW}}

% abbreviations
\def\RARROW{$\rightarrow$}
\def\LARROW{$\leftarrow$}
\def\UARROW{$\uparrow$}
\def\DARROW{$\downarrow$}
\def\DAGGER{$\dagger$}
\def\UDAGGER#1{$^{\dagger #1}$}
\def\DDAGGER{$\ddagger$}
\def\UDDAGGER#1{$^{\ddagger #1}$}
\def\CDOTS{$\cdots$}
\def\LDOTS{$\ldots$}
\def\VDOTS{$\vdots$}
\def\YEN{Y\llap=}		% yen sign
\def\Rarrow{\hspace{5pt}\RARROW\hspace{5pt}}

\def\CONT{\ \ {\rm{\scriptsize{(次の行に続く)}}}}
\def\CMND#1#2#3{\vspace{#1}\relax\\
	    \hspace{10pt}\tt{\framebox[\linewidth][l]{\hspace{5pt}#2}}
	    \relax\vspace{#3}}

\def\TAG#1{\tt{\orgLA#1\orgRA}}
\def\BUILDANDTEST{ビルド\&テスト}
\def\VUP{\vspace{-12pt}\\}	% adjustment for virtical spacing

\def\WID{20pt}			% indent width
\def\NOTE{\small{$^\dagger$}}
\def\NOTEd{\small{$^\ddagger$}}

% typewriter font
\def\ENVVAR#1{\tt{\,\$#1\,}}	% for environment variable name (preceded by '$')
\def\MACRO#1{\tt{\,\$#1\,}}	% for manro name (preceded by '$')
\def\FUNC#1{\tt{\,#1\,}}	% for function name
\def\METHOD#1{\tt{\,#1\,}}	% for method name
\def\VAR#1{\tt{\,#1\,}}		% for variable name
\def\ARG#1{\tt{\,#1\,}}		% for argument name
\def\CONST#1{\tt{\,#1\,}}	% for constant name
\def\FILE#1{\tt{\,"#1"\,}}	% for file name (double quoted)
\def\PATH#1{\tt{\,"#1"\,}}	% for path name (double quoted)
\def\ENV#1{\tt{#1}}		% for Windows environment variable name
\def\ENVREF#1{\tt{\%#1\%}}	% for Windows environment variable reference

\def\Path#1{\DQuote{\tt{#1}}}

\def\Ref#1#2{\ref{#1:#2} #2}
\def\REF#1#2{``\ref{#1:#2} #2''参照}

% source quotation
\def\BEGINQUOTE{%
	\\\rule{0pt}{1.8em}
	{\scriptsize{\DARROW \DARROW ここから \DARROW \DARROW}}\\}
\def\ENDQUOTE{%
	{\scriptsize{\UARROW \UARROW ここまで \UARROW \UARROW}}\\
	\rule{0pt}{1.9em}}

%% quoted word
\def\SQuote#1{\hbox{\,\raise.4ex\hbox{{\tt `}}#1\tt{\raise.4ex\hbox{{\tt '}}}\,}}
\def\DQuote#1{\hbox{\,\raise.4ex\hbox{{\tt "}}#1\tt{\raise.4ex\hbox{{\tt "}}}\,}}

%% rule
%\def\rrule#1{\vbox{%
%    \vspace{-1.0\baselineskip}
%    \begin{flushright}
%    \begin{tabular}{c} \hbox to #1{}\\\hline \end{tabular}
%    \end{flushright}}
%    \vspace{-0.5\baselineskip}}

% helper macro for dirtree

% styles for class description
%
\def\ClassDesc{\medskip\noindent\bf{概要}\begingroup\begin{narrow}[20pt]}
\def\endClassDesc{\end{narrow}\endgroup}

\def\Initializer#1{%	in-line '\\' is ok
	\vspace{.35\baselineskip}\noindent\bf{イニシャライザ} (\tt{__init__)}
	\begin{narrow}[20pt]\hspace{-.6em}%
	\tt{\begin{tabular}{l}#1\end{tabular}}\vspace{.3\baselineskip}\\}
\def\endInitializer{\end{narrow}}

\def\Methods#1{\vspace{.35\baselineskip}%
	\noindent\bf{#1}\begin{narrow}[5pt]\begin{enumerate}}
\def\endMethods{\end{enumerate}\end{narrow}}
\def\Method#1#2{\vspace{.35\baselineskip}\item\tt{#1}\\#2}

\def\General{\bf{概要}\begin{narrow}[20pt]}
\def\endGeneral{\end{narrow}}
\def\LineSkip#1{\end{narrow}\vspace{#1}\begin{narrow}[20pt]}

\def\Process{\bf{処理}\begin{narrow}[20pt]\relax}
\def\endProcess{\end{narrow}}

\def\Params{\@ifnextchar[{\Params@}{\Params@[6em]}}
\def\Params@[#1]{\noindent\bf{引数}\vspace{-1.6\baselineskip}\\
	\def\Params@name@wid{#1}
	\def\Params@desc@wid{\linewidth}
	\addtolength{\Params@desc@wid}{-\Params@name@wid}
	\addtolength{\Params@desc@wid}{-25pt}
	\begin{longtable}[r]{p{\Params@name@wid}l}}
\def\endParams{\end{longtable}\vspace{-1.1\baselineskip}}
\def\Param#1#2{%
	\tt{#1}&\begin{minipage}[t]{\Params@desc@wid}#2

	\vspace{.2\baselineskip}\end{minipage}\\}
\def\ParamLong#1#2{%
	\multicolumn{2}{l}{\tt{#1}}\\
	&\begin{minipage}[t]{\Params@desc@wid}#2

	\vspace{.2\baselineskip}\end{minipage}\\}

\def\ParTable{\@ifnextchar[{\ParTable@}{\ParTable@[6em]}}
\def\ParTable@[#1]{%
	\def\ParTable@name@wid{#1}
	\def\ParTable@desc@wid{\linewidth}
	\addtolength{\ParTable@desc@wid}{-\ParTable@name@wid}
	\addtolength{\ParTable@desc@wid}{-25pt}
	\begin{longtable}[r]{p{\ParTable@name@wid}l}}
\def\endParTable{\end{longtable}\vspace{-.6\baselineskip}}



%\def\endparcol{\\\vspace{-.65\baselineskip}\end{minipage}}

%% styles for function description
%%
%\def\FuncDesc{\medskip\begingroup\begin{narrow}[10pt]}
%\def\endFuncDesc{\end{narrow}\endgroup}
%
%\def\FuncArgs{\medskip\begingroup\begin{narrow}[10pt]
%	\bf{引数}\\
%	\begin{tabular}{@{\hspace{15pt}}ll}}
%\def\endFuncArgs{\end{tabular}\end{narrow}\endgroup}
%
%\def\FuncProc{\medskip\begingroup\begin{narrow}[10pt]
%	\bf{処理}
%	\begin{narrow}[8pt]\begin{enumerate}
%	\setlength\itemsep{.5em}}
%\def\endFuncProc{\end{enumerate}\end{narrow}\end{narrow}\endgroup}

%% narrower
% \narrow[size][margin]
%	charsize:	t, f, s, [n]
%	margin:		[\the\leftmargin]
% \end{narrow}
%
\def\narrow{\@ifnextchar[{\narrow@}{\narrow@def[Z][\the\leftmargin]}}
\def\narrow@[#1]{%
	\@ifnextchar[{\narrow@def[#1]}{\narrow@@[#1]}}
\def\narrow@@[#1]{%
	\ifx#1t \def\@size{t} \def\@mgn{\the\leftmargin} \else
	\ifx#1f \def\@size{f} \def\@mgn{\the\leftmargin} \else
	\ifx#1s \def\@size{s} \def\@mgn{\the\leftmargin} \else
	\ifx#1n \def\@size{n} \def\@mgn{\the\leftmargin} \else
	\ifx#1l \def\@size{l} \def\@mgn{\the\leftmargin} \else
		\def\@size{Z} \def\@mgn{#1}	\fi\fi\fi\fi\fi
	\narrow@def[\@size][\@mgn]}
\def\narrow@repl#1{\def\@lmgn{\the\leftmargin} \def\@text{[#1]}}
\def\narrow@same#1{\def\@lmgn{#1} \def\@text{}}
\def\narrow@def[#1][#2]{%
	\if#1t \def\font@def{Y} \let\font@size\tiny	    \else
	\if#1f \def\font@def{Y} \let\font@size\footnotesize \else
	\if#1s \def\font@def{Y} \let\font@size\small	    \else
	\if#1n \def\font@def{Y} \let\font@size\normalsize   \else
	\if#1l \def\font@def{Y} \let\font@size\large	    \else
	\if#1Z \def\font@def{Y} \let\font@size\relax	    \else
	       \def\font@def{N} \let\font@size\relax	    \fi\fi\fi\fi\fi\fi
	\if\font@def Y \narrow@same{#2} \else \narrow@repl{#2} \fi
	\list{}{\topsep 0pt \partopsep 0pt \parsep 0pt \itemsep 0pt
		\rightmargin 0pt \leftmargin \@lmgn \relax}\item[]
	\begingroup\font@size\@text}
\def\end@narrow{\endgroup\endlist}
\let\endnarrow\end@narrow

%% table with rightmost foldable column
% \begin{Table}[pos][fix part width]{table spec}
%   \Item[*]{column width(**)}{last column}	(*) t(\tt), i(\it), r(\rm)
%						(**) without last column
%   \MC is alias to \multicolumn
% \end{Table}
\def\Table{\@ifnextchar[{\Table@@}{\Table@[c]}}
\def\Table@{\@ifnexechar[{\Table@@}{\Table@@[c][6em]}}
\def\Table@@[#1][#2]#3{\begingroup
	%\let\org@Table@arraystretch\arraystretch
	%\def\arraystretch{0.8}
	\def\Table@name@wid{#2}
	\def\Table@desc@wid{\linewidth}
	\addtolength{\Table@desc@wid}{-\Table@name@wid}
	\addtolength{\Table@desc@wid}{-25pt}
	\begin{longtable}[#1]{#3}}
\def\end@Table{\end{longtable}
	%\let\arraystretch\prg@arraystretch
	\endgroup}
\let\endTable\end@Table

\def\Item{\@ifnextchar[{\Item@}{\Item@[n]}}
\def\Item@[#1]#2#3{%
	\if#1t \def\type@face{\tt}	\else
	\if#1i \def\type@face{\it}	\else
	\if#1b \def\type@face{\bf}	\else
	       \def\type@face{\relax}	\fi\fi\fi
	\hbox to \Table@name@wid{\hbox{\type@face{#2}\hfill}}
	&\begin{minipage}[t]{\Table@desc@wid}#3

	\vspace{.2\baselineskip}\end{minipage}\\}
\let\MC\multicolumn

%
%% table columnn with paragraph
% \parcol[shrink]{width}{body}
%	shrink:		shrink baselineskip by this value [-.2\baselineskip]
%
\def\parcol{\@ifnextchar[{\parcol@}{\parcol@[-.2\baselineskip]}}
\def\parcol@[#1]#2#3{%
	\addtolength{\baselineskip}{#1}
	\begin{minipage}[t]{#2}#3}
\def\endparcol{\\\vspace{-.65\baselineskip}\end{minipage}}

\makeatother
% end: marco.tex
