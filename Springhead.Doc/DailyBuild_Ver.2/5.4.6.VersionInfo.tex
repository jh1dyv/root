% 5.4.6.VersionInfo.tex
%	Last update: 2018/06/18 F.Kanehori
%\newpage
\subsubsection{VersionInfo}
\label{subsubsec:VersionInfo}

\bigskip
\framebox{\begin{tabular}{l}\begin{minipage}[t]{\linewidth}
	現在、ここに記述する内容の実装(コード)は、
	ファイル\Path{VersionControlSystem.py}の
	\Path{__main__}節に記述されている。
	将来的には、この部分をファイル\Path{VersionInfo.py}として
	独立させた方がよいであろう \CDOTS\ (TODO)。
\end{minipage}\end{tabular}}

\bigskip
\noindent
起動方法
\Cmnd{4pt}
     {python VersionControlSystem.py [options] \{HEAD | all | commit-id\}}
     {-2pt}

\begin{CmndOpts}[5em]
    \CmndOpt{-S $^{(1)}$}{Subversionを対象とする(DailyBuildでは使用しない)}
    \CmndOpt{-G $^{(2)}$}{Github (GitHub.com)を対象とする}
    \CmndOpt{-H $^{(3)}$}{Gitlab (git.haselab.net)を対象とする}
    \CmndOpt{-f FNAME}{旧バージョンから取得するファイル名}
\end{CmndOpts}
\vspace{-.2\baselineskip}
\begin{narrow}[f][\WID]
    \begin{Table}[r][1em]{ll}
	\Item{$^{(1)}$}{%
		GitHubに移行する前に使用していたもの。
		メンテナンスしないとおそらく動作しない。
		Webページの表示にも影響が出るので注意。}
	\Item{$^{(2)}$}{Springheadのレポジトリである}
	\Item{$^{(3)}$}{DailyBuild/Resultのレポジトリである}
    \end{Table}
\end{narrow}
\vspace{-1.8\baselineskip}

\begin{CmndArgs}[5em]
    \CmndArg{HEAD}{HEADバージョンを対象とする}
    \CmndArg{all}{すべてのバージョンを対象とする}
    \CmndArg{commit-id}{指定したバージョンを対象とする}
\end{CmndArgs}

\begin{Process}
\begin{enumerate}
  \item	このプログラムは\tt{"core/test"}から起動されることを前提としている。

  \item	gitには、その管理下にあるディレクトリからアクセスしないといけない。
	以下に、指定されたオプションと管理下ディレクトリの対応を示す。\\
	\begin{narrow}[20pt]
	    \begin{tabular}{|ll@{ $\Leftrightarrow$ }l|}\hline
		\tt{-S}	& \tt{url}
			& \tt{http://springhead.info/spr2/Springhead/trunk/}\\
			& \tt{dir}
			& \Path{../../..}\\\hline
		\tt{-G} & \tt{url}
			& \tt{http://github.com/sprphys/Springhead/}\\
			& \tt{dir}
			& \Path{../../../../Springhead}\\\hline
		\tt{-H}	& \tt{url}
			& \tt{http://git.haselab.net/DailyBuild/Result/}\\
			& \tt{dir}
			& \Path{../../../../DailyBuildResult/Result}\\\hline
	    \end{tabular}
	\end{narrow}
	\medskip

  \item	オプション\tt{-S}が指定された場合
	この場合はクラス\tt{VersionControlSystem}のテストプログラム
	そのものである。DailyBuildからは使用されない。
	\medskip

  \item	オプション\tt{-G}が指定された場合
	\begin{enumerate}
	  \item	オプション\tt{-f FNAME}が指定された場合\\
		引数で指定されたバージョン
		(\tt{all}の場合は全バージョン)から
		\tt{FNAME}で指定されたファイルを取得し、
		次の形式で標準出力に出力する。

		\medskip
		\begin{narrow}
		\framebox{\begin{tabular}{@{\hspace{5pt}}l@{\hspace{5pt}}}
		    \tt{--[\it{short-id,long-id,YYYY-mmdd,HH:MM:ss}]--}\\
		    取得したファイルの内容
		\end{tabular}}
		\end{narrow}

		\medskip
		\it{short-id}はコミットIDの短縮形式、
		\it{long-id}はコミットIDを表す。\\
		引数\tt{all}が指定された場合は、
		上記の形式を全バージョンに対して繰り返す。

	  \item	オプション\tt{-f FNAME}が指定されない場合\\
		引数で指定されたバージョン
		(\tt{all}の場合は全バージョン)について、
		次の情報を標準出力に出力する。

		\medskip
		\begin{narrow}
		\framebox{\begin{tabular}{@{\hspace{5pt}}l@{\hspace{5pt}}}
		    \it{short-id,long-id,YYYY-mmdd,HH:MM:SS}
		\end{tabular}}
		\end{narrow}

		\medskip
		\it{short-id}はコミットIDの短縮形式、
		\it{long-id}はコミットIDを表す。\\
		引数\TT{all}が指定された場合は、上記の形式を全バージョンに
		対して繰り返す。
	\end{enumerate}
	\medskip
\end{enumerate}
\end{Process}

% end: 5.4.6.VersionInfo.tex
